# 권한 매트릭스

## 전역 권한 (GlobalRole)

| 기능 | USER | MANAGER | ADMIN |
|------|------|---------|-------|
| **일반 기능** |
| 메인 게시글 작성 | ✅ | ✅ | ✅ |
| 메인 게시글 수정/삭제 | 본인만 | 본인만 | ✅ |
| 댓글 작성 | ✅ | ✅ | ✅ |
| 댓글 수정/삭제 | 본인만 | 본인만 | ✅ |
| 좋아요/북마크 | ✅ | ✅ | ✅ |
| **관리 기능** |
| 게시글 승인/거부 | ❌ | ✅ | ✅ |
| 전역 Ban 실행 | ❌ | ❌ | ✅ |
| 관리자 페이지 접근 | ❌ | ✅ | ✅ |
| 카테고리 관리 | ❌ | ❌ | ✅ |
| 사용자 역할 변경 | ❌ | ❌ | ✅ |

## 커뮤니티 권한 (CommunityRole)

| 기능 | MEMBER | MODERATOR | ADMIN | OWNER |
|------|--------|-----------|-------|-------|
| **일반 기능** |
| 게시글 작성 | ✅ | ✅ | ✅ | ✅ |
| 게시글 수정/삭제 | 본인만 | ✅ | ✅ | ✅ |
| 댓글 작성 | ✅ | ✅ | ✅ | ✅ |
| 댓글 수정/삭제 | 본인만 | 본인 또는 하위 역할 작성 | 본인 또는 하위 역할 작성 | 모두 |
| **관리 기능** |
| 멤버 Ban | ❌ | MEMBER만 | MEMBER, MOD | 모두 |
| 멤버 역할 변경 | ❌ | ❌ | MEMBER→MOD | 모두 |
| 카테고리 생성/수정 | ❌ | ❌ | ✅ | ✅ |
| 공지사항 작성 | ❌ | ✅ | ✅ | ✅ |
| 공지사항 수정/삭제 | ❌ | 본인 또는 MEMBER 작성 | 본인 또는 하위 역할 작성 | 모두 |
| 커뮤니티 설정 변경* | ❌ | ❌ | ✅ | ✅ |
| 커뮤니티 삭제 | ❌ | ❌ | ❌ | ✅ |
| 소유권 이전** | ❌ | ❌ | ❌ | ✅ |

*커뮤니티 설정: 이름, 설명, 규칙, 이미지, 공개여부(PUBLIC/PRIVATE), 파일업로드 허용, 채팅 허용, 파일크기 제한
**소유권 이전: ownerId 변경, 새 소유자가 OWNER 권한 획득, 이전 소유자는 MEMBER로 변경

## Ban 권한 상세

### 전역 Ban (User.isBanned)
- **실행 가능**: ADMIN만
- **대상**: 모든 사용자
- **효과**: 사이트 전체 접근 제한

### 커뮤니티 Ban (CommunityMember.status = BANNED)
- **실행 가능**: 
  - OWNER: 모든 멤버 Ban 가능
  - ADMIN: MODERATOR와 MEMBER Ban 가능
  - MODERATOR: MEMBER만 Ban 가능
- **효과**: 해당 커뮤니티만 접근 제한

## 중요 원칙
1. 상위 권한은 하위 권한의 모든 기능 포함
2. 본인보다 높거나 같은 권한은 Ban 불가
3. 소유권 관련 기능은 OWNER만 가능
4. **GlobalRole.ADMIN은 모든 커뮤니티에서 자동으로 ADMIN 권한 보유**
5. 사이트 관리자(GlobalRole.ADMIN)는 커뮤니티 Ban을 받을 수 없음
6. **콘텐츠 수정/삭제 계층 원칙**:
   - 본인이 작성한 콘텐츠는 항상 수정/삭제 가능
   - 상위 권한자가 작성한 콘텐츠는 하위 권한자가 수정/삭제 불가
   - 작성 시점의 권한을 기준으로 판단 (권한 변경 후에도 유지)
   - 모든 콘텐츠(게시글, 댓글, 공지사항)는 작성 시점의 역할(authorRole)을 저장
   - 권한 계층: OWNER > ADMIN > MODERATOR > MEMBER (커뮤니티)
   - 권한 계층: ADMIN > MANAGER > USER (전역)