# 채팅 시스템 재설계 문서

## 🎯 목표
글로벌 채팅과 커뮤니티 채팅을 명확히 분리하여 더 나은 UX 제공

## 📊 현재 문제점
1. 모든 채팅이 플로팅 버튼으로만 접근 가능
2. 커뮤니티 채팅이 숨겨져 있어 활성화 낮음
3. 글로벌과 커뮤니티 채팅이 섞여있음

## ✨ 새로운 구조

### 1. 글로벌 채팅 (플로팅 전용)
- **접근**: 플로팅 버튼 (우하단 고정)
- **대상**: 전체 사이트 사용자
- **특징**: 어디서든 접근 가능, 페이지 이동해도 유지

### 2. 커뮤니티 채팅 (내장형)
- **접근**: 커뮤니티 페이지 내부
- **대상**: 해당 커뮤니티 멤버
- **특징**: 커뮤니티의 핵심 기능으로 노출

## 🖥️ 반응형 레이아웃

### 데스크톱 (1024px+)
```
┌─────────────────────────────────────────────┐
│              커뮤니티 헤더                   │
├──────────────────────────┬──────────────────┤
│                          │                  │
│      메인 콘텐츠          │   채팅 사이드바    │
│    (게시글/멤버/공지)      │    (300-400px)   │
│                          │                  │
│                          │  [토글 버튼]      │
└──────────────────────────┴──────────────────┘

[플로팅 버튼] → 글로벌 채팅만
```

### 태블릿 (768px-1023px)
```
┌─────────────────────────────────────────────┐
│              커뮤니티 헤더                   │
├─────────────────────────────────────────────┤
│  [게시글] [멤버] [공지] [💬 채팅]            │ ← 탭 네비게이션
├─────────────────────────────────────────────┤
│                                             │
│           선택된 탭 콘텐츠                    │
│                                             │
└─────────────────────────────────────────────┘
```

### 모바일 (767px 이하)
```
┌────────────────────┐
│   커뮤니티 헤더     │
├────────────────────┤
│                    │
│    메인 콘텐츠      │
│                    │
├────────────────────┤
│ 📝  👥  📢  💬  ⚙️ │ ← 하단 네비게이션 바
└────────────────────┘
```

## 🔧 구현 계획

### Phase 1: 기본 구조 변경
```typescript
// 1. FloatingChatButton 수정
- ChatChannelList에서 GLOBAL 채널만 표시
- 커뮤니티 채널 제거

// 2. 커뮤니티 채팅 컴포넌트 생성
components/communities/
├── CommunityChatPanel.tsx     // 데스크톱 사이드바
├── CommunityChatTab.tsx        // 태블릿 탭 콘텐츠
└── CommunityChatMobile.tsx     // 모바일 전체화면

// 3. 레이아웃 수정
app/communities/[id]/layout.tsx // 사이드바 레이아웃 추가
```

### Phase 2: UI 개선
```typescript
// 1. 채팅 기능 강화
- 이모지 리액션
- 스레드/답글
- @멘션
- 파일 미리보기 개선
- 코드 신택스 하이라이팅

// 2. 사용성 개선
- 메시지 검색
- 고정 메시지
- 알림 설정
- 읽음 표시
```

### Phase 3: 성능 최적화
```typescript
// 1. 실시간 통신 개선
- WebSocket 도입 검토
- Redis pub/sub 적용
- 메시지 페이지네이션

// 2. 캐싱 전략
- React Query 활용
- 메시지 캐싱
- 이미지 최적화
```

## 📦 필요한 컴포넌트 (21st.dev/Magic)

### 커뮤니티 채팅용
```
1. Discord 스타일 사이드바 채팅
   - 채널 정보 헤더
   - 메시지 리스트
   - 입력창
   - 온라인 사용자 목록

2. 탭 네비게이션 시스템
   - 스와이프 지원
   - 아이콘 + 텍스트
   - 배지 (미읽은 메시지)

3. 모바일 채팅 UI
   - 전체화면 모드
   - 하단 입력창
   - 제스처 지원
```

### 공통 개선사항
```
1. 이모지 피커
   - 최근 사용 이모지
   - 카테고리별 정리
   - 검색 기능

2. 멘션 시스템
   - @사용자 자동완성
   - @channel, @here
   - 멘션 알림

3. 리치 텍스트 에디터
   - 마크다운 지원
   - 코드 블록
   - 이미지 붙여넣기
```

## 🎨 디자인 가이드라인

### 네오브루털리즘 유지
- 검은 테두리 (border-2 border-black)
- 하드 섀도우 (shadow-[4px_4px_0px_0px_rgba(0,0,0,1)])
- 굵은 타이포그래피
- 선명한 색상

### 채팅 특화 스타일
```css
/* 메시지 버블 */
.message {
  border: 2px solid black;
  box-shadow: 2px 2px 0px rgba(0,0,0,1);
  border-radius: 8px;
}

/* 사이드바 */
.chat-sidebar {
  border-left: 2px solid black;
  background: white;
}

/* 입력창 */
.chat-input {
  border: 2px solid black;
  box-shadow: inset 2px 2px 0px rgba(0,0,0,0.1);
}
```

## 📈 예상 효과

1. **사용성 향상**
   - 커뮤니티 채팅 활성화 30% 증가 예상
   - 메시지 전송량 50% 증가 예상

2. **명확한 구분**
   - 글로벌 vs 커뮤니티 혼동 제거
   - 각 용도에 맞는 최적화된 UI

3. **반응형 개선**
   - 모든 디바이스에서 최적 경험
   - 네이티브 앱 같은 UX

## ⚠️ 주의사항

1. **기존 사용자 마이그레이션**
   - 변경사항 공지
   - 튜토리얼 제공

2. **성능 모니터링**
   - 동시 접속자 수 체크
   - 메시지 처리 속도 확인

3. **접근성**
   - 키보드 네비게이션
   - 스크린 리더 지원
   - 고대비 모드